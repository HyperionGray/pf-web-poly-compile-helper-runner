# Exploit Development Tools - Always Available
# Modern exploit development and binary analysis
# Category: Security/Exploit Development

task checksec
  describe Check binary security features
  shell checksec --file=${binary}
end

task pwn-cyclic
  describe Generate cyclic pattern for buffer overflow
  shell python3 -c "import pwn; print(pwn.cyclic(${length:-1000}))"
end

task pwn-cyclic-find
  describe Find offset in cyclic pattern
  shell python3 -c "import pwn; print('Offset:', pwn.cyclic_find('${pattern}'))"
end

task pwn-shellcode
  describe Generate shellcode for architecture
  shell python3 -c "import pwn; pwn.context.arch='${arch:-amd64}'; print(pwn.shellcraft.sh())"
end

task rop-find-gadgets
  describe Find all ROP gadgets in binary
  shell ROPgadget --binary ${binary} ${output:+> $output}
end

task exploit-help
  describe Show exploit development help
  shell echo "Exploit Development Tasks (Always Available):"
  shell echo "  pf install-exploit-tools          # Install all tools"
  shell echo "  pf checksec binary=<file>         # Check security features"
  shell echo "  pf pwn-cyclic length=1000         # Generate pattern"
  shell echo "  pf pwn-cyclic-find pattern=<hex>  # Find offset"
  shell echo "  pf rop-find-gadgets binary=<file> # Find ROP gadgets"
end
